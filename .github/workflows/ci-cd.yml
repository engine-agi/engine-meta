name: CI/CD Pipeline

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main, develop ]

jobs:
  validate:
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v4

    - name: Validate documentation
      run: |
        [ -f README.md ] && echo "README found" || echo "README missing"
        find docs/ -name "*.md" -exec echo "Doc found: {}" \; 2>/dev/null || echo "No docs directory"

    - name: Check scripts
      run: |
        if [ -d scripts/ ]; then
          find scripts/ -name "*.sh" -exec bash -n {} \; && echo "Scripts syntax OK"
        fi

    - name: Validate JSON/YAML files
      run: |
        find . -name "*.json" -exec python -m json.tool {} \; >/dev/null && echo "JSON files OK"
        find . -name "*.yaml" -o -name "*.yml" | head -5 | xargs -I {} sh -c 'python -c "import yaml; yaml.safe_load(open(\"{}\"))" && echo "{} OK"' || echo "YAML validation completed"